# 5장. 데이터베이스 설계와 ER 모델

## 1. 데이터베이스 설계 개요

- **정의**
  - 데이터베이스 설계는 한 조직체의 운영과 목적을 지원하기 위해 데이터베이스를 생성하는 과정이다.
  - 데이터베이스 설계의 목적은 모든 주요 응용과 사용자들이 요구하는 데이터와 데이터 간의 관계를 표현하는 것이다.
- **주요 단계**
  - **요구사항 분석**: 문서 조사, 인터뷰, 설문 등을 통해 데이터와 연산 요구사항을 수집·분석한다.
  - **개념적 설계**: 요구사항을 바탕으로 엔티티, 관계, 애트리뷰트 등을 식별하여 개념적 스키마(주로 ER 다이어그램)로 표현한다.
  - **DBMS 선정**: 데이터 모델, 저장 구조, 인터페이스, 질의어, 비용 등 다양한 요인을 고려해 DBMS를 선택한다.
  - **논리적 설계**: 개념적 스키마를 선택된 DBMS의 데이터 모델(관계, 계층, 네트워크 등)에 맞게 변환한다.
  - **스키마 정제**: 중복 제거, 정규화 등을 통해 스키마를 최적화한다.
  - **물리적 설계**: 저장 구조, 접근 경로, 인덱스 등을 결정하여 성능을 최적화한다.
  - **보안 설계**: 사용자 그룹, 접근 제한 등을 설계한다.
  - **구현 및 튜닝**: 데이터베이스 구축, 데이터 적재, 응용 프로그램 변환, 성능 튜닝 등을 수행한다.
- **설계의 중요성**
  - 시간에 따른 데이터의 모든 측면을 반영하고, 중복 최소화, 효율적 접근, 무결성, 이해 용이 등이 요구된다.

## 2. 개념적 데이터베이스 설계와 ER 모델

- **개념적 설계란?**
  - 실제 구현과 독립적으로 조직체의 정보 사용 모델을 개발하는 과정이다.
  - 추상화 수준이 높으며, 엔티티, 관계, 프로세스, 무결성 제약조건 등을 포함한다.
- **ER 모델(Entity-Relationship Model)**
  - 1976년 P.P. Chen이 제안한 개념적 데이터 모델로, 실세계를 엔티티, 애트리뷰트, 관계로 표현한다.
  - ER 다이어그램은 데이터베이스 구조와 관계를 시각적으로 이해할 수 있게 해준다.
- **ER 모델의 주요 구성 요소**
  - **엔티티(Entity)**: 사람, 장소, 사물 등 실세계의 객체(예: 사원, 부서, 프로젝트).
  - **애트리뷰트(Attribute)**: 엔티티의 속성(예: 사원번호, 이름, 직책).
  - **관계(Relationship)**: 엔티티들 간의 연관(예: 사원이 부서에 소속됨).
- **강한/약한 엔티티 타입**
  - **강한 엔티티 타입**: 독자적으로 존재하며, 자신의 키 애트리뷰트로 식별 가능(예: 사원).
  - **약한 엔티티 타입**: 키를 형성할 수 없어 소유 엔티티 타입의 키와 결합해 식별(예: 부양가족).
- **애트리뷰트의 유형**
  - **단순/복합 애트리뷰트**: 단순은 더 이상 분해 불가, 복합은 여러 애트리뷰트로 구성.
  - **단일값/다치 애트리뷰트**: 단일값은 하나의 값, 다치는 여러 값.
  - **저장/유도 애트리뷰트**: 저장은 직접 저장, 유도는 계산 등으로 얻어짐.
- **키 애트리뷰트**
  - 엔티티를 고유하게 식별하는 애트리뷰트(예: 사원번호).
  - ER 다이어그램에서 밑줄로 표시.

## 3. 관계(Relationship)와 관계 타입

- **관계란?**
  - 두 개 이상의 엔티티 타입 사이의 연관이나 연결.
  - 요구사항 명세에서 동사로 표현되는 경우가 많다(예: 근무한다, 소속된다).
- **관계 타입/관계 집합**
  - **관계 타입**: 동질의 관계들의 틀.
  - **관계 집합**: 동질의 관계들의 모임.
  - ER 다이어그램에서 다이어몬드로 표시.
- **차수(Degree)**
  - 관계로 연결된 엔티티 타입의 개수(예: 2진, 3진 관계).
- **카디날리티(Cardinality)**
  - 한 엔티티가 관계에 참여할 수 있는 수(예: 1:1, 1:N, M:N).
  - (min, max) 형태로 표기(예: (1,1), (0,*) 등).
- **전체 참여/부분 참여**
  - **전체 참여**: 모든 엔티티가 관계에 참여(이중 실선으로 표시).
  - **부분 참여**: 일부 엔티티만 관계에 참여.
- **역할(Role)**
  - 관계 타입의 의미를 명확히 하기 위해 사용(특히 하나의 엔티티 타입이 여러 번 참여할 때).
- **관계의 애트리뷰트**
  - 관계 타입이 갖는 애트리뷰트(예: 근무 기간, 역할 등).

## 4. 데이터베이스 설계 사례

- **예시 요구사항**
  - 회사에는 다수의 사원, 부서, 프로젝트, 부품, 공급자가 존재.
  - 사원은 부서에 소속, 프로젝트에 참여, 부양가족을 가질 수 있음.
  - 프로젝트는 여러 위치에서 진행, 여러 사원이 참여, 한 명의 관리자가 있음.
  - 부품은 여러 프로젝트에서 사용, 여러 부품으로 구성될 수 있음.
  - 공급자는 여러 부품을 여러 프로젝트에 공급.
- **엔티티 타입 및 애트리뷰트 식별**
  - 사원(사원번호, 이름, 직책, 급여, 주소), 부서(부서번호, 이름, 층), 프로젝트(프로젝트번호, 이름, 예산, 위치), 부품(부품번호, 이름, 가격), 공급자(공급자번호, 이름, 신용도), 부양가족(이름, 성별).
- **관계 및 애트리뷰트 식별**
  - 근무한다, 소속된다, 참여한다, 공급한다 등 다양한 관계와 각 관계의 애트리뷰트(예: 근무 기간, 역할, 수량 등).

## 5. 논리적 설계: ER 스키마를 관계 모델의 릴레이션으로 사상

- **사상 알고리즘**
  - **단계 1: 정규 엔티티 타입과 단일값 애트리뷰트**
    - 각 정규 엔티티 타입에 대해 릴레이션 생성, 단순 애트리뷰트 포함, 기본키 설정.
  - **단계 2: 약한 엔티티 타입과 단일값 애트리뷰트**
    - 약한 엔티티 타입에 대해 릴레이션 생성, 소유 엔티티 타입의 기본키를 외래키로 포함, 기본키는 부분키와 외래키의 조합.
  - **단계 3: 2진 1:1 관계 타입**
    - 참여 엔티티 타입 중 하나에 외래키 추가, 관계 애트리뷰트 포함.
  - **단계 4: 정규 2진 1:N 관계 타입**
    - N측 엔티티 타입에 1측 엔티티 타입의 기본키를 외래키로 포함, 관계 애트리뷰트 포함.
  - **단계 5: 2진 M:N 관계 타입**
    - 별도의 릴레이션 생성, 참여 엔티티 타입의 기본키를 외래키로 포함, 조합이 기본키.
  - **단계 6: 3진 이상의 관계 타입**
    - 별도의 릴레이션 생성, 참여 엔티티 타입의 기본키를 외래키로 포함, 조합이 기본키.
  - **단계 7: 다치 애트리뷰트**
    - 별도의 릴레이션 생성, 다치 애트리뷰트와 외래키 포함, 조합이 기본키[1].
- **사례 적용 결과**
  - 사원, 부서, 프로젝트, 부품, 공급자, 부양가족, 근무, 공급 등 다양한 릴레이션으로 사상.

## 6. 요약 및 기타

- **ER 모델의 장점**
  - 이해하기 쉽고, 구현에 독립적이며, 사용자와 설계자 간의 의사소통에 용이하다.
  - 다양한 CASE 도구(ERWin 등)에서 지원된다.
- **ER 다이어그램 표기법**
  - 엔티티: 직사각형, 애트리뷰트: 타원, 관계: 다이어몬드, 키: 밑줄, 다치: 이중 타원, 유도: 점선 타원 등.
- **데이터베이스 설계의 중요성**
  - 체계적인 설계는 데이터 중복, 불일치, 무결성 문제를 예방하고, 효율적인 데이터 관리와 응용 프로그램 개발을 지원한다.

---
