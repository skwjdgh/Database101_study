## 4. 서브쿼리
### 4. 서브쿼리
- **스칼라 서브쿼리**: SELECT 절에 사용
- **인라인뷰**: FROM 절에 사용
- **WHERE 절 서브쿼리**: 단일행, 다중행, 다중컬럼, 연관/비연관 서브쿼리
- **EXISTS, NOT EXISTS**: 존재 여부에 따라 결과 반환
```
-- 1. 스칼라 서브쿼리: SELECT 절에 사용 (단일값 반환)
SELECT emp_name, salary,
       (SELECT AVG(salary) FROM employees) AS avg_salary
FROM employees;

-- 2. 인라인뷰: FROM 절에 사용 (서브쿼리 결과를 테이블처럼 사용)
SELECT e.emp_name, d.dept_name
FROM (SELECT emp_id, emp_name, dept_id FROM employees WHERE salary > 3000) e
JOIN departments d ON e.dept_id = d.dept_id;

-- 3. WHERE 절 서브쿼리
-- 3-1. 단일행 서브쿼리 (결과가 1행)
SELECT emp_name, salary
FROM employees
WHERE salary > (SELECT AVG(salary) FROM employees);

-- 3-2. 다중행 서브쿼리 (결과가 여러 행, IN 사용)
SELECT emp_name, dept_id
FROM employees
WHERE dept_id IN (SELECT dept_id FROM departments WHERE location = '서울');

-- 3-3. 다중컬럼 서브쿼리 (결과가 여러 컬럼)
SELECT emp_name, dept_id, salary
FROM employees
WHERE (dept_id, salary) IN (SELECT dept_id, MAX(salary) FROM employees GROUP BY dept_id);

-- 3-4. 연관서브쿼리 (메인쿼리와 서브쿼리 간 연관)
SELECT e1.emp_name, e1.salary
FROM employees e1
WHERE salary > (SELECT AVG(salary) FROM employees e2 WHERE e2.dept_id = e1.dept_id);

-- 4. EXISTS, NOT EXISTS: 존재 여부에 따라 결과 반환
SELECT dept_name
FROM departments d
WHERE EXISTS (SELECT 1 FROM employees e WHERE e.dept_id = d.dept_id);

SELECT dept_name
FROM departments d
WHERE NOT EXISTS (SELECT 1 FROM employees e WHERE e.dept_id = d.dept_id);
```