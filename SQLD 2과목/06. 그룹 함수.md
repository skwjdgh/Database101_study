## 6. 그룹 함수
### 6. 그룹 함수
- **GROUPING SETS**: 여러 그룹화 결과 합집합
- **ROLLUP**: 소계, 전체계
- **CUBE**: 모든 조합의 소계, 전체계

```
-- 샘플 테이블 생성
CREATE TABLE emp (
  dept_id NUMBER,
  job_id VARCHAR2(10),
  salary NUMBER
);

INSERT INTO emp VALUES (10, 'DEV', 3000);
INSERT INTO emp VALUES (10, 'DEV', 3500);
INSERT INTO emp VALUES (10, 'HR', 4000);
INSERT INTO emp VALUES (20, 'HR', 4500);
INSERT INTO emp VALUES (20, 'MKT', 5000);

-- 1. GROUPING SETS: 여러 그룹화 결과 합집합
SELECT 
  NVL(TO_CHAR(dept_id), '전체') AS 부서,
  NVL(job_id, '전체') AS 직무,
  SUM(salary) AS 총급여
FROM emp
GROUP BY GROUPING SETS ((dept_id, job_id), dept_id, job_id)
ORDER BY dept_id, job_id;

/*
결과:
부서 | 직무 | 총급여
10   | DEV  | 6500
10   | HR   | 4000
10   | 전체 | 10500
20   | HR   | 4500
20   | MKT  | 5000
20   | 전체 | 9500
전체 | DEV  | 6500
전체 | HR   | 8500
전체 | MKT  | 5000
*/

-- 2. ROLLUP: 계층적 소계(부서 → 직무 → 전체)
SELECT 
  NVL(TO_CHAR(dept_id), '전체') AS 부서,
  NVL(job_id, '전체') AS 직무,
  SUM(salary) AS 총급여
FROM emp
GROUP BY ROLLUP(dept_id, job_id)
ORDER BY dept_id, job_id;

/*
결과:
부서 | 직무 | 총급여
10   | DEV  | 6500
10   | HR   | 4000
10   | 전체 | 10500
20   | HR   | 4500
20   | MKT  | 5000
20   | 전체 | 9500
전체 | 전체 | 20000
*/

-- 3. CUBE: 모든 조합의 소계 생성
SELECT 
  NVL(TO_CHAR(dept_id), '전체') AS 부서,
  NVL(job_id, '전체') AS 직무,
  SUM(salary) AS 총급여
FROM emp
GROUP BY CUBE(dept_id, job_id)
ORDER BY dept_id, job_id;

/*
결과:
부서 | 직무 | 총급여
10   | DEV  | 6500
10   | HR   | 4000
10   | 전체 | 10500
20   | HR   | 4500
20   | MKT  | 5000
20   | 전체 | 9500
전체 | DEV  | 6500
전체 | HR   | 8500
전체 | MKT  | 5000
전체 | 전체 | 20000
*/

-- 4. GROUPING 함수: 집계 여부 확인(0: 원본 데이터, 1: 집계 데이터)
SELECT 
  dept_id,
  job_id,
  SUM(salary),
  GROUPING(dept_id) AS dept_group,
  GROUPING(job_id) AS job_group
FROM emp
GROUP BY ROLLUP(dept_id, job_id);
```